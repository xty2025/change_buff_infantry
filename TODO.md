## 主线
一定要完成的功能
以下描述都是问题得到完美解决的最高/理想要求，实际开发可以适当降低要求。
- [ ] 1. 重写Solver，将目前使用线性多项式拟合的pitch,yaw和camera坐标的计算方式改为坐标系变换等方式。要求在引入常量时通过主函数json参数传入值修改以便于调参，且**需要实际上车验证定中心点观测定位置装甲板旋转云台时解算得到世界坐标变动幅度<0.15°**。（该功能主要为了解决相机侧放坐标转换问题）
- [ ] 2. 开发Tracker功能。将Detector的输出结果进行整车观测框与装甲板观测数据的融合匹配，要求**考虑到极端情况下机器人重叠等问题，设计稳健的跟踪机制**。
- [ ] 3. 开发Predictor功能。适配新的观测量整车观测框cx,radius+旧观测量装甲板xyz,pitch进行车辆相位中心估计，再结合Kalman滤波器进行运动预测。希望能够做到1.在短时间内（<5帧）给出车辆中心xyz三方向位置速度预测，角速度预测，当前可视装甲板位置预测，车辆半径估计。2.观测较长时间后给出四装甲板高度预测（而非一直假定装甲板高度对称安装），双半径（如果有的话）估计，且希望Predictor能够给出当前状态是否稳定的判断，并在合适情况下重启。
- [ ] 4. 完善Controller功能1。实现上位机层面的~~嵌软plus~~控制优化功能。即指写一个辅助程序测试嵌软当前PID参数响应延迟、响应幅度、能否达到设定值等功能，并导出参数通过主动放大，超前控制量达到补偿嵌软控制的功能。
- [ ] 5. 完善Controller功能2。完善选板火控逻辑，通过类似惩罚/奖励/损失的计算来判断当前环境下如何选板、火控、**跟随装甲板/定点击打选择**，需结合敌方距离，装甲板朝向，转速等进行命中率预估，并藉此调整策略。

## 支线
一些小问题或不太重要的功能
- [ ] 1. 解决使用网页调参主流程循环latency由8ms增至11ms的问题。
- [ ] 2. 开发类似TUI的日志功能，解决目前日志输出难读的问题。
- [ ] 3. 开发VOFA的调试插件，实现类似foxglove的可视化目标状态观测可视化功能。
- [ ] 4. 开发安全利用灰色装甲板数据的算法以应对装甲板打击闪烁问题。（注意到可能出现红蓝双方同兵种均被击打变灰导致匹配崩溃的问题）
- [ ] 5. 开发判断敌方车辆是否在掩体后/相机边缘的算法，并在此时在Predictor中弃用部分新数据以避免错误数据输入导致崩溃。
- [ ] 6. **测量静止靶击打情况，添加相机pitch偏置参数和功能，力图达到5m内弹速稳定情况下高度差±1m情况下静止靶均击打在小装甲板中央的完美效果。**
- [ ] 7. 写大小装甲板区分输入Solver的代码（现在是默认小装甲板）~~（我不知道我为啥现在还没写这个功能）~~
- [ ] 8. 设计弹速动态调整功能，根据下位机实时弹速对弹速进行更新。
- [ ] 9. 整理JSON配置文件，如果可能的话，考虑使用YAML配置更加方便。（主要是支持注释）
- [ ] 10.调查并解决测距不精确/补偿问题。
- [ ] 11.设计算法判断对方车辆是圆形还是方形，进而选择不同的模型进行半径估算，相位拟合等预测功能。
- [ ] 12.把可能需要调整的参数都移动到配置文件中方便调参。

## FUTURE
一些未来可能会做或想实现或花里胡哨无实际价值的功能
- [ ] 1. 开发前哨站击打，基地击打功能
- [ ] 2. 开发针对敌方轮腿上下小陀螺情形的运动预测功能（如果Predictor不原生支持的话）
- [ ] 3. 开发飞镖致盲情况下的自动辅瞄反击功能（目前规则允许）（循环转头+开火）
- [ ] 4. 开发反不规则小陀螺功能（进行一定程度上的速度拟合或进行慢速旋转区间的预测并只打慢速情形）
- [ ] 5. 开发2D平面地图视觉定位（有图定位）功能
- [ ] 6. ~~自动步兵启动！！！~~

## 打符
To be continued...

## Tips
- 目前引入整车识别的目的是想模仿人眼对车辆的识别方式，达到快速的中心、相位估计。同时还可以将旋转与平移解耦，推测能够大幅度提高辅瞄性能。但同时可能导致上场无法识别辅瞄失效情况等。所以可能还需要设计一些机制来判断是否使用旧Predictor方法~~旧的我也没写好~~。
- 实际测试同时运行两个模型延迟仍然在10ms左右，完全在可接受范围。
- 闲的话可以试试测试辅助工具的性能，如Location的自动调用转换，TimeStamp之类的。以前第一版时测试性能影响很低，但目前修改后不太确定。
- 有一些很规范的cpp/hpp文件注释很多，大概率是AI写的，使用小心。